{"tests": [

  {
    "description":"valid link 1",
    "input":"[text](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:27"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:28"}
    ],
    "errors":[]
  },

  {
    "description":"valid link 2",
    "input":"[a&b](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "CHARACTER", "text": "a&b", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:26"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:27"}
    ],
    "errors":[]
  },

  {
    "description":"valid link 3",
    "input":"[\\*a\\*](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "CHARACTER", "text": "*a*", "position": "1:3"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:28"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:29"}
    ],
    "errors":[]
  },

  {
    "description":"valid link 4",
    "input":"[\\<a\\>](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "CHARACTER", "text": "&lt;a&gt;", "position": "1:3"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:28"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:29"}
    ],
    "errors":[]
  },

  {
    "description":"void []",
    "input":"[](text)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "[](text)", "position": "1:1"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:9"}
    ],
    "errors":[
      { "description": "void square bracket definition", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"link with no url",
    "input":"[text]()",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:8"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:9"}
    ],
    "errors":[
      { "description": "undefined hyperlink URL", "line": 1, "col": 8 }
    ]
  },

  {
    "description":"link with EOF in url start",
    "input":"[text](",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:8"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:8"}
    ],
    "errors":[
      { "description": "undefined hyperlink URL", "line": 1, "col": 8 },
      { "description": "EOF in hyperlink", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"link with newline in url start",
    "input":"[text](\n",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:8"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "2:1"}
    ],
    "errors":[
      { "description": "newline in hyperlink URL", "line": 1, "col": 8 },
      { "description": "undefined hyperlink URL", "line": 1, "col": 8 }
    ]
  },

  {
    "description":"malformed link with no url",
    "input":"[text]",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "[text]", "position": "1:1"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:7"}
    ],
    "errors":[
      { "description": "invalid square bracket declaration format", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"abrupt EOF in link text 1",
    "input":"[",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "[", "position": "1:1"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:2"}
    ],
    "errors":[]
  },

  {
    "description":"abrupt EOF in link text 2",
    "input":"[text",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "[text", "position": "1:1"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:6"}
    ],
    "errors":[]
  },

  {
    "description":"newline in hyperlink url",
    "input":"[text](ur\nl)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "ur", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:10"},
      {"type": "CHARACTER", "text": "l)", "position": "2:1"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "2:3"}
    ],
    "errors":[
      { "description": "newline in hyperlink URL", "line": 1, "col": 10 }
    ]
  },

  {
    "description":"abrupt EOF in link url 1",
    "input":"[text](",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:8"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:8"}
    ],
    "errors":[
      { "description": "undefined hyperlink URL", "line": 1, "col": 8 },
      { "description": "EOF in hyperlink", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"abrupt EOF in link url 2",
    "input":"[text](http",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "http", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:12"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:12"}
    ],
    "errors":[
      { "description": "EOF in hyperlink", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"valid link with nested formatting",
    "input":"[*text*](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:2"},
      {"type": "CHARACTER", "text": "text", "position": "1:3"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:7"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:29"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:30"}
    ],
    "errors":[]
  },

  {
    "description":"valid link with nested formatting opening",
    "input":"[*text](https://example.com)*",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:2"},
      {"type": "CHARACTER", "text": "text", "position": "1:3"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:28"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:29"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:30"}
    ],
    "errors":[]
  },

  {
    "description":"valid link with mid formatted text",
    "input":"*text [*link*](url)*",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:1"},
      {"type": "CHARACTER", "text": "text ", "position": "1:2"},
      {"type": "HYPERLINK", "url": "url", "position": "1:7"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:8"},
      {"type": "CHARACTER", "text": "link", "position": "1:9"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:13"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:19"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:20"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:21"}
    ],
    "errors":[]
  },

  {
    "description":"valid link with nested formatting closing",
    "input":"*[text*](https://example.com)*",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:2"},
      {"type": "CHARACTER", "text": "text", "position": "1:3"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:7"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:29"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:30"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:31"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:31"}
    ],
    "errors":[]
  },

  {
    "description":"valid link with html special characters in url",
    "input":"[text](https://example.com/<query>&?)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com/&lt;query&gt;&amp;?", "position": "1:1"},
      {"type": "CHARACTER", "text": "text", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:37"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:38"}
    ],
    "errors":[]
  },

  {
    "description":"abrupt EOF in formatted link text 1",
    "input":"*[text",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:1"},
      {"type": "CHARACTER", "text": "[text", "position": "1:2"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:7"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:7"}
    ],
    "errors":[]
  },

  {
    "description":"abrupt EOF in formatted link text 2",
    "input":"[*text]",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "CHARACTER", "text": "[", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:2"},
      {"type": "CHARACTER", "text": "text]", "position": "1:3"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:8"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:8"}
    ],
    "errors":[
      { "description": "invalid square bracket declaration format", "line": 1, "col": 1 }
    ]
  },

  {
    "description":"abrupt EOF in formatted link",
    "input":"*[text](url",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "FORMAT_BEGIN", "formatting": "ITALIC", "text": "*", "position": "1:1"},
      {"type": "HYPERLINK", "url": "url", "position": "1:2"},
      {"type": "CHARACTER", "text": "text", "position": "1:3"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:12"},
      {"type": "FORMAT_END", "formatting": "ITALIC", "text": "*", "position": "1:12"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:12"}
    ],
    "errors":[
      { "description": "EOF in hyperlink", "line": 1, "col": 2 }
    ]
  },

  {
    "description":"valid link with block id",
    "input":"[text {#block-id}](https://example.com)",
    "tokens":[
      {"type": "PARAGRAPH", "id": "", "position": "1:1"},
      {"type": "HYPERLINK", "url": "https://example.com", "position": "1:1"},
      {"type": "CHARACTER", "text": "text {#block-id}", "position": "1:2"},
      {"type": "BLOCK_END", "block": "HYPERLINK", "position": "1:39"},
      {"type": "BLOCK_END", "block": "PARAGRAPH", "position": "1:40"}
    ],
    "errors":[]
  }

]}